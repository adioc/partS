**所需技巧:** ps, excel. 一小部分js

**情景:** 有一份电子图片杂志，需要里面的照片，但只提供浏览器阅览和手机端两种方式。

**遇到问题：** 浏览器预览时，每张图（每页）是被裁剪开的，裁剪为了3部分，就像这样：![image004](https://github.com/adioc/partS/assets/33523055/0b5423be-bf34-4465-ba20-52b772e53618)

**解决方式：**

通过查看网页代码，找到对应的裁剪后的图片资源，直接保存在本地。但直接保存太慢，想要使用脚本批量保存，后又发现有大量重复。选择了最费劲的人力保存方法，共249张，全靠人力保存下来。
保存的方式采用从浏览器控制台中鼠标悬停在链接上后，显示预览图，再拖动预览图到文件夹（页面中的鼠标被禁用了，使用右键解禁后也无效），这时又遇到问题：拖到本地文件夹中的图片名称统一为“download.jpg”，重名无法解决。最后，找到破解之法：将图片拖到excel文件中，每行放一个，这样操作后图片会有一点质量损失，差不多10k以内，但图片本身也不大，90-130k。

解决了图片到本地的问题，如何将图片从excel中提取出来又成了问题，后来查找到了excel另存为网页的方式。另存为网页后，图片会统一存放在文件夹中，而且按照顺序（行号？加入顺序？）编号，挺方便的，不过格式存原有的jpg变为了png，要说的话还挺便于后续ps操作的，不过文件大小打了20多倍，变成了2M左右。

后面就是合成，合成原本想着使用ps脚本自动化解决，结果不太行（技艺有问题，或者本身不太可行），改为了半自动的方式将上中下三部分分别进行对齐，分开建立了动作。首先是上，上的特点是高度最大，所有照片的宽度都是相同的，高度不同，其中上部分的高度最大。选择上作为开始，将画布高度相对扩大200%，上部分复制一份，将其与画布（新版中有画布对齐，老版本中用的是新建图层填充后移动到最下作为画布代替）对齐，上对齐结束。中对齐，导入中图，将中图与画布底对齐，中图到最低，中图与上图原始位置顶对齐（之前移动的是复制的那一份，总之留了一份），中图对齐了（其实中间差一点，9个像素，幸好所有图片都是如此，加在动作了就好）。下对齐，导入下图，选中中图，建立选区，增加上部选区，反向选择，新建图层并填充，这样就得到了中图底的位置，并将其转化为了新图层的顶部，取消选区，将下图与画布对齐，挪至最低（为了向上拉平），下图再与新建图层顶对齐，完毕（同样有9像素问题）。最后就是图片截取问题，调整可见性，盖印，建立选区，截图，保存。

建好动作后，开始批量操作发现个问题，动作中记录了图层名，而对于中下图，文件名即图层名，导致动作通用很成问题。试着将图层重命名添加到了动作中，将图层名改为动作中记录的图层名，问题成功解决，注意要选中图层后开始录制动作。另外动作中的记录也是可以拖动和删除的，现在才知道（也许是忘了）。另外一开始将下图对齐和文件截图保存分开了，很影响效率，后来合并在一起，并加入了关文件，效率up！！还有一点，是动作选项提供了功能键，刚开始没用后来尝试后惊为天人，附带将变废为宝的鼠标功能键进行更改（调整为了回车，简化了导入新图后的确认过程）。


**Tips：**
ps中的对齐无论顶底，都是向最上/下的一张对齐，即向上/下拉平；

logi option更改键位确实能简化很多操作；

**思考：**

- 如果掌握了js，可以免去图片下载的苦工。

- 关于ps半自动，如果python掌握的好，倒也用不到手动了

- excel还是有很多东西需要了解的

- 687日元（33块）花的不知道算不算亏，总体上没啥感觉，收藏多了一份，后续分享出来吧
